!function(a){var b=a("#add-assets-form"),c=a("#file-preview-template");if(b.length&&c.length){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=c.get(0).innerHTML,x=a("#upload-previews"),y=!1,z=[],A=0,B=0,C=0,D=1,E=2;c.remove(),e=function(b){b.previewElement=a(Mustache.render(w,{name:b.name,size:d.filesize(b.size),type:b.type,tabindex:v()})).get(0),x.append(b.previewElement),a(b.previewElement).data("file",b),p()},f=function(b){a(b.previewElement).fadeOut(200,function(){a(this).remove()}),p()},q=function(b,c){a(b.previewElement).find("img.preview-thumbnail").attr("src",c)},g=function(){var c=a(this).closest(".asset-preview"),e=c&&c.data("file");return"undefined"!=typeof e&&(d.removeFile(e),b.find(".choose-files-trigger").prop("disabled",!1).removeClass("disabled"),p()),!1},h=function(){if(b.valid()){var c=d.getFilesWithStatus(Dropzone.ADDED);c.length&&(s=b.serializeObject(),A=0,B=0,y=!0,d.enqueueFiles(c),b.find("li[data-step='1']").addClass("complete").removeClass("active"),b.find("li[data-step='2']").addClass("active"),b.find(".upload-options").fadeOut(200,function(){a(this).remove(),b.find(".upload-progress").removeClass("hide")}))}return!1},i=function(b,c,d){var e=a(b.previewElement),f=e.find("input[ name='asset-title' ]"),g=f.val(),h=h||f.width();a.trim(g).length||(g=b.name),d.append("title",g);for(var i in s)d.append(i,s[i]);e.find(".upload-detail").html('<div class="progress progress-striped active" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" style="width:'+h+'px;"><span class="progress-bar-placeholder">'+g+'</span><div class="progress-bar progress-bar-success" style="width:0%;"></div></div>')},j=function(b,c,d){var e=a(b.previewElement),f=e.find(".progress-bar");f.width(c+"%")},k=function(a){$progressBar=b.find(".total-progress .progress-bar"),$progressBar.width(a+"%")},m=function(a,b,c){"object"==typeof b&&"undefined"!=typeof b.message?u(a,b.message):"undefined"==typeof c?(u(a,b),p()):u(a,i18n.translateResource("cms:assetmanager.upload.failure.http.message",{data:[c.status+" "+c.statusText]}))},n=function(a,b){"object"==typeof b&&"undefined"!=typeof b.success?b.success?t(a,b.message,b.id):u(a,b.message):u(a,i18n.translateResource("cms:assetmanager.upload.failure.http.message",{data:["200 OK"]}))},t=function(b,c,d){var e=a(b.previewElement),f=e.find(".upload-detail");z.push(d),B++,f.html(c),e.addClass("upload-success"),e.find(".action-buttons").html('<i class="fa fa-fw fa-check bigger-130 green"></i>')},u=function(b,c){var d=a(b.previewElement),e=d.find(".upload-detail");A++,e.html(c),d.addClass("upload-error"),d.find(".action-buttons").html('<i class="fa fa-fw fa-ban bigger-130 red"></i>')},p=function(){var a=d.getFilesWithStatus(Dropzone.ADDED);a.length?(b.find(".no-files-chosen-message").hide(),b.find(".upload-files-trigger").removeAttr("disabled")):(b.find(".no-files-chosen-message").show(),b.find(".upload-files-trigger").attr("disabled","disabled"))},l=function(){y&&(b.trigger("assetsUploaded"),b.find(".upload-progress").fadeOut(200,function(){a(this).remove();var c,d="undefined"!=typeof s.asset_folder?s.asset_folder:"",e=r(),f=[".complete-success",".partial-success",".complete-failure"],g=b.find(".return-to-folder-link"),h=b.find(".start-over-link");for(f.splice(e,1),c=0;c<f.length;c++)b.find(f[c]).remove();g.attr("href",g.attr("href")+d),h.attr("href",h.attr("href")+d),b.find(".upload-results").removeClass("hide")}),b.find("li[data-step='2']").addClass("complete").removeClass("active"),b.find("li[data-step='3']").addClass("active"))},o=function(){b.find(".choose-files-trigger").prop("disabled",!0).addClass("disabled")},r=function(){return A>0&&B>0?D:B>0?C:E},v=function(){var b=0;return a("[tabindex]").each(function(){var c=parseInt(a(this).attr("tabindex"));!isNaN(c)&&c>b&&(b=c)}),b+1},d=new Dropzone(a("body").get(0),{url:b.attr("action"),thumbnailWidth:50,thumbnailHeight:50,parallelUploads:cfrequest.parallelUploads||5,autoQueue:!1,clickable:".choose-files-trigger",maxFilesize:cfrequest.maxFileSize||100,maxFiles:cfrequest.maxFiles||null,acceptedFiles:cfrequest.allowedExtensions||"",addedfile:e,thumbnail:q,sending:i,uploadprogress:j,totaluploadprogress:k,queuecomplete:l,error:m,success:n,maxfilesreached:o,dictDefaultMessage:i18n.translateResource("cms:assetmanager.uploader.messages.dictDefaultMessage"),dictFallbackMessage:i18n.translateResource("cms:assetmanager.uploader.messages.dictFallbackMessage"),dictFallbackText:i18n.translateResource("cms:assetmanager.uploader.messages.dictFallbackText"),dictFileTooBig:i18n.translateResource("cms:assetmanager.uploader.messages.dictFileTooBig"),dictInvalidFileType:i18n.translateResource("cms:assetmanager.uploader.messages.dictInvalidFileType"),dictResponseError:i18n.translateResource("cms:assetmanager.uploader.messages.dictResponseError"),dictCancelUpload:i18n.translateResource("cms:assetmanager.uploader.messages.dictCancelUpload"),dictCancelUploadConfirmation:i18n.translateResource("cms:assetmanager.uploader.messages.dictCancelUploadConfirmation"),dictRemoveFile:i18n.translateResource("cms:assetmanager.uploader.messages.dictRemoveFile"),dictRemoveFileConfirmation:i18n.translateResource("cms:assetmanager.uploader.messages.dictRemoveFileConfirmation"),dictMaxFilesExceeded:i18n.translateResource("cms:assetmanager.uploader.messages.dictMaxFilesExceeded")}),b.on("click",".cancel-file-trigger",g),b.on("click",".upload-files-trigger",h),b.data("presdideUploader",{getUploadedAssetIds:function(){return z}})}}(presideJQuery);
//# sourceMappingURL=_uploadAssets.min.map